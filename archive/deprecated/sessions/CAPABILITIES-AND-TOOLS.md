# MINIX Analysis: Capabilities, Tools, and Execution Framework

**Document Version**: 1.0.0
**Date**: 2025-10-30
**Author**: Claude Code (Sonnet 4.5)
**Purpose**: Comprehensive inventory of available tools, agents, and execution capabilities

---

## I. MCP (Model Context Protocol) Servers Available

### Shared MINIX Analysis Server Layer

The repository now exposes a reusable MCP-facing façade directly from the codebase:

- Package: `shared/mcp/server/` (`MinixDataLoader`, `MinixAnalysisServer`)
- Data source: JSON exports under `diagrams/data/` generated by `make pipeline`
- Access options:
  - **Programmatic**: import `MinixAnalysisServer` and call helpers (architecture, boot, performance, syscall lookup, resource listing).
  - **CLI**: (ensure `PYTHONPATH=<repo>/src`) `python -m os_analysis_toolkit.cli --list-resources`, `--resource <name> [--boot-aspect ...]`, `--syscall <name>`, `--kernel-summary [--top-syscalls N]`, `--boot-critical-path`, `--data-dir <path>`.

> Transport integration: Hook the shared server into any MCP runtime (e.g., `mcp/servers/minix-analysis`) by instantiating `MinixAnalysisServer.from_default_data_dir()` and exposing the results via tool handlers. This consolidation replaces the historical per-module copies referenced later in this document.


### 1. Desktop Commander (`mcp__desktop-commander`)
**Capabilities**: Advanced file operations, process management, and system interaction

**Key Tools**:
- **File Operations**: `read_file`, `write_file`, `edit_block`, `read_multiple_files`
  - Supports offset/length for partial reads
  - Chunking support for large files (25-30 line chunks recommended)
  - Surgical text replacement with `edit_block`

- **Directory Operations**: `list_directory`, `create_directory`, `move_file`
  - Recursive listing with depth control
  - Context overflow protection (100 items per nested dir)

- **Search Capabilities**: `start_search`, `get_more_search_results`, `stop_search`
  - File search (by name patterns)
  - Content search (grep-like functionality)
  - Streaming results with offset-based pagination
  - Literal vs regex search modes

- **Process Management**: `start_process`, `interact_with_process`, `read_process_output`
  - Interactive REPL support (Python, Node.js, bash, etc.)
  - Smart prompt detection for early exit
  - Critical for local file analysis (CSV, JSON, data processing)

- **System Info**: `get_config`, `get_usage_stats`, `get_recent_tool_calls`

**Performance Features**:
- Verbose timing telemetry available
- Early exit detection for REPLs
- Intelligent timeout management

**Best Practices**:
- **ALWAYS** use absolute paths
- Use processes for file analysis (NOT analysis tool for local files)
- Chunk large file writes (25-30 lines max per call)

---

### 2. Filesystem (`mcp__filesystem`)
**Capabilities**: Direct filesystem access with enhanced features

**Key Tools**:
- `read_text_file`: Read with head/tail support
- `read_media_file`: Image/audio files (base64 encoded)
- `read_multiple_files`: Batch file reads
- `write_file`: Create/overwrite files
- `edit_file`: Line-based edits with git-style diff preview
- `list_directory`, `list_directory_with_sizes`: Enhanced directory listings
- `directory_tree`: Recursive JSON tree structure
- `search_files`: Pattern-based file discovery
- `get_file_info`: Detailed file metadata

**Advantages**:
- Git-style diff preview for edits
- Batch operations
- Size-aware directory listings

---

### 3. Memory (`mcp__memory`)
**Capabilities**: Knowledge graph for persistent entity/relation tracking

**Key Tools**:
- `create_entities`: Add entities with observations
- `create_relations`: Define entity relationships
- `add_observations`: Extend entity knowledge
- `search_nodes`: Query knowledge graph
- `open_nodes`: Retrieve specific entities
- `delete_entities`, `delete_relations`, `delete_observations`: Cleanup

**Use Cases**:
- Track codebase entities (functions, modules, files)
- Document architectural relationships
- Maintain project knowledge across sessions

---

### 4. Puppeteer (`mcp__puppeteer`)
**Capabilities**: Browser automation and web scraping

**Key Tools**:
- `puppeteer_connect_active_tab`: Connect to Chrome with remote debugging
- `puppeteer_navigate`: Navigate to URLs
- `puppeteer_screenshot`: Capture page/element screenshots
- `puppeteer_click`, `puppeteer_fill`, `puppeteer_select`: Interaction
- `puppeteer_evaluate`: Execute JavaScript in browser

**Use Cases**:
- Web research and documentation retrieval
- Interactive testing
- Screenshot generation

---

### 5. Playwright (`mcp__playwright`)
**Capabilities**: Advanced browser testing and automation

**Key Tools**:
- `init-browser`: Initialize with URL
- `get-screenshot`: Page screenshots
- `execute-code`: Custom Playwright code execution
- `get-context`: Website context for test generation

**Advantages**:
- More robust than Puppeteer
- Better for test automation
- Full async function support

---

### 6. NPM Search (`mcp__npm-search`)
**Capabilities**: Search npm package registry

**Tools**:
- `search_npm_packages`: Find JavaScript/Node packages

**Use Cases**:
- Dependency discovery
- Package research

---

### 7. Fetch (`mcp__fetch`)
**Capabilities**: Web content retrieval and extraction

**Tools**:
- `fetch`: URL fetching with markdown conversion
  - HTML → Markdown processing
  - Content analysis with prompts
  - 15-minute cache for efficiency

**Use Cases**:
- Documentation retrieval
- Web research
- Content extraction

---

### 8. SQLite (`mcp__sqlite`)
**Capabilities**: SQLite database operations

**Tools**:
- `db_info`: Database metadata
- `query`: Raw SQL execution
- `list_tables`, `get_table_schema`: Schema exploration
- `create_record`, `read_records`, `update_records`, `delete_records`: CRUD operations

---

### 9. PostgreSQL (`mcp__postgres`)
**Capabilities**: PostgreSQL read-only queries

**Tools**:
- `query`: Execute SELECT queries

---

### 10. Time (`mcp__time`)
**Capabilities**: Timezone conversions

**Tools**:
- `get_current_time`: Time in specific timezone
- `convert_time`: Convert between timezones

---

### 11. Everything (`mcp__everything`)
**Capabilities**: MCP protocol testing and demonstration

**Tools**: (17 tools for testing protocol features)
- `echo`, `add`: Basic operations
- `longRunningOperation`: Progress updates
- `sampleLLM`: MCP sampling feature
- `getTinyImage`: Image handling
- `annotatedMessage`: Content metadata
- `structuredContent`: Schema validation

---

## II. Specialized Agents Available

### General Purpose Agents

#### 1. **general-purpose**
- Multi-step task automation
- Complex question research
- Code search
- All tools available

#### 2. **Explore**
- Fast codebase exploration
- File pattern matching (glob patterns)
- Keyword search
- Thoroughness levels: quick, medium, very thorough
- **Use when**: Exploring unfamiliar codebase, finding patterns, answering "how does X work?"

#### 3. **Plan**
- Planning and architecture design
- Same capabilities as Explore
- Strategic thinking focus

---

### Specialized Technical Agents

#### 4. **phd-software-engineer**
- Expert-level software engineering
- Complex system design
- Performance optimization
- Multi-paradigm programming
- **Use when**: Architectural decisions, performance-critical code, expert guidance needed

#### 5. **polyglot-systems-architect**
- Multi-language system design
- Language interoperability (C/C++, Haskell, Rust, etc.)
- Cross-platform architecture
- Hardware-software co-design
- **Use when**: Multi-language projects, FFI design, systems programming

#### 6. **category-theory-expert**
- Advanced mathematics
- Formal verification
- Type theory guidance
- Categorical modeling
- Monad laws and coherence conditions
- **Use when**: Type-level programming, formal verification, mathematical rigor needed

---

### Domain-Specific Agents

#### 7. **logic-computation-historian**
- History of computation and logic
- Ancient to modern computing evolution
- Curriculum design for computational thought
- Cross-cultural contributions
- **Use when**: Research context, historical analysis, educational content

#### 8. **tikz-whitepaper-synthesizer**
- Scientific visualization with TikZ/PGFPlots
- Publication-quality figures
- PDF generation
- LaTeX expertise
- **Use when**: Creating papers, diagrams, whitepapers, ArXiv submissions

---

### Operating System Specialists (ChickenOS series)

#### 9. **chickenos-chief-architect**
- Cross-cutting OS design decisions
- Technical debt management
- Architectural coherence
- Phase 0 validation
- Integration planning

#### 10. **chickenos-memory-specialist**
- Page allocator
- Virtual memory management
- Copy-on-write
- DMA zones
- x86_64 MMU expertise

#### 11. **chickenos-scheduler-specialist**
- Continuation-based context switching
- CFS timeline scheduler
- Timer interrupts
- Process management

#### 12. **chickenos-vfs-specialist**
- S-expression VFS
- In-memory filesystem
- Path resolution
- Mounting

#### 13. **chickenos-syscall-specialist**
- Syscall dispatcher
- Parameter marshalling
- Security checks
- 300+ POSIX syscalls
- x86_64 syscall/sysret

#### 14. **chickenos-driver-specialist**
- Hardware drivers
- Serial, keyboard, framebuffer, disk, network
- x86_64 I/O (port I/O, MMIO)
- DMA and interrupts

#### 15. **chickenos-shell-specialist**
- POSIX shell implementation
- REPL, parser, pipeline executor
- Job control
- Built-in commands

#### 16. **chickenos-integration-test**
- Testing and QA
- Unit tests, integration tests
- POSIX compliance
- CI/CD automation

#### 17. **chickenos-posix-utils-generator**
- Batch-generating 150+ POSIX utilities
- Templates and code generation
- POSIX specification expertise

---

### Orchestration Agents

#### 18. **multi-agent-orchestrator**
- Coordinates multiple specialized agents
- Multi-domain problem solving
- **Use when**: Complex projects spanning multiple technical domains

#### 19. **statusline-setup**
- Configure Claude Code status line
- Limited to Read/Edit tools

---

## III. Built-in Tools

### Core File Operations
- **Read**: Read files with offset/limit
- **Edit**: Exact string replacement (preserves indentation)
- **Write**: Create new files or overwrite
- **Glob**: Pattern-based file finding
- **Grep**: Content search with regex

### Code Operations
- **NotebookEdit**: Jupyter notebook cell editing

### Execution
- **Bash**: Shell command execution
  - Approved commands: python, node, git, cargo, make, cmake, docker, etc.
  - POSIX compliance emphasis
  - Error handling with `set -eu`

### Web
- **WebFetch**: Fetch and process URLs
- **WebSearch**: Search engine integration

### Task Management
- **TodoWrite**: Task tracking (actively used in this session)
- **AskUserQuestion**: Interactive Q&A with user

### Agents
- **Task**: Launch specialized agents for complex work

### Background
- **BashOutput**: Monitor background shell output
- **KillShell**: Terminate background processes

---

## IV. Tool Usage Philosophy

### File Operations Hierarchy
1. **Specialized tools** (Read, Edit, Write) → **PREFERRED**
2. **MCP servers** (filesystem, desktop-commander) → **ALTERNATIVE**
3. **Bash commands** (cat, sed, awk) → **AVOID** (use only for actual system commands)

### Search Strategy
1. **Specific file/class query** → Use Glob/Grep directly
2. **Exploratory/broad query** → Use Explore agent
3. **Multi-file analysis** → Use general-purpose agent

### Data Analysis Workflow (CRITICAL)
**For ANY local file analysis (CSV, JSON, logs, etc.)**:

```bash
# CORRECT: Use processes
start_process("python3 -i")
interact_with_process(pid, "import pandas as pd")
interact_with_process(pid, "df = pd.read_csv('/path/file.csv')")
interact_with_process(pid, "print(df.describe())")

# WRONG: Analysis tool cannot access local files - WILL FAIL
```

---

## V. Parallel Execution Patterns

### When to Run Tools in Parallel
1. **Independent file reads** → Single message, multiple Read calls
2. **Multiple searches** → Concurrent Grep/Glob
3. **Bash commands** (if independent) → Multiple Bash calls in one message

### When to Run Sequentially
1. **Dependent operations** → Wait for results before next call
2. **File Write → Bash** → Sequential (e.g., create file then git commit)
3. **mkdir before cp** → Sequential

---

## VI. Agent Coordination Best Practices

### Agent Selection Matrix

| Task Type | Primary Agent | Secondary Agent |
|-----------|--------------|-----------------|
| Codebase exploration | Explore (medium) | general-purpose |
| Architectural design | polyglot-systems-architect | phd-software-engineer |
| Performance optimization | phd-software-engineer | polyglot-systems-architect |
| Type-level programming | category-theory-expert | phd-software-engineer |
| LaTeX/visualization | tikz-whitepaper-synthesizer | - |
| Historical research | logic-computation-historian | - |
| Multi-domain integration | multi-agent-orchestrator | - |
| OS internals | chickenos-chief-architect | (+ specific specialists) |

### Agent Invocation Guidelines
1. **Use Task tool** with appropriate `subagent_type`
2. **Provide detailed prompt** (agents are stateless)
3. **Specify expected output** clearly
4. **Trust agent outputs** (generally reliable)
5. **Parallel invocation** when tasks are independent

---

## VII. Quality Assurance Framework

### Build Discipline
- **Treat all warnings as errors**
- **Continuous requirements.md updates**
- **Comprehensive dependency documentation**
- **Reproducible builds** (Makefile-based)

### Testing Standards
- **Backend**: >90% code coverage
- **Integration**: End-to-end workflows
- **Validation**: namcap, shellcheck, shfmt

### Documentation Standards
- **ASCII-only** (no Unicode in docs)
- **Primary sources** with citations
- **Version-specific** references
- **Reproducibility** focus

---

## VIII. CachyOS/Arch Environment Notes

### Package Management
- **PKGBUILD-first** approach
- All system changes as proper packages
- namcap validation required
- pacman integration mandatory

### Kernel Options
- linux-cachyos (BORE scheduler)
- linux-cachyos-eevdf
- linux-cachyos-deckify

### Optimization
- x86-64-v3 baseline (NOT v4 on Zen 3)
- Measured performance tuning
- Conservative defaults

---

## IX. Current Session Context

### Active Directory
- **Working Dir**: `/home/eirikr/Playground/minix-analysis`
- **Git Repo**: Yes
- **Platform**: Linux (CachyOS)
- **Shell**: zsh (interactive), POSIX sh (scripts)

### Task at Hand
**Objective**: Merge minix-boot-analyzer into minix-analysis umbrella structure

**Current State**:
- ✅ Phase 1 complete (project renamed)
- ⏳ Phases 2-7 pending (see MIGRATION-PLAN.md)

**Key Files**:
- `MIGRATION-PLAN.md`: 7-phase migration roadmap (3-4 hours)
- `UMBRELLA-ARCHITECTURE.md`: Target architecture
- `README.md`: Current project state

---

## X. Execution Strategy for Current Task

### Phase-by-Phase Approach
1. **Phase 2**: Extract shared LaTeX styles → 20 min
2. **Phase 3**: Migrate CPU module → 30 min
3. **Phase 4**: Migrate Boot module → 45 min
4. **Phase 5**: Consolidate MCP server → 30 min
5. **Phase 6**: Create build system → 20 min
6. **Phase 7**: Documentation & testing → 30 min

### Validation Gates
- LaTeX compilation after each phase
- MCP server import tests
- Directory structure verification
- Wiki build validation

### Risk Mitigation
- Backup exists (pre-migration)
- Reversible operations
- Incremental verification
- Clear rollback plan

---

## XI. Next Actions (Prioritized)

1. **Complete MCP/Agent capability documentation** ✅ (this document)
2. **Create detailed requirements.md**
3. **Deep codebase audit** (identify gaps/errors)
4. **Execute MIGRATION-PLAN.md Phases 2-7**
5. **Comprehensive testing validation**
6. **Generate ultra-detailed roadmap**

---

**AD ASTRA PER MATHEMATICA ET SCIENTIAM**

*Tools mastered. Capabilities documented. Execution imminent.*
